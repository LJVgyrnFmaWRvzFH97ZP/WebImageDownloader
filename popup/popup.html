<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Web Image Downloader</title>
  <link href="../dist/css/styles.css" rel="stylesheet">
  <script defer type="module" src="./popup.js"></script>
  <script defer src="../dist/js/alpine-csp.min.js"></script>
</head>

<body x-data="WebImageDownloaderPopup" class="w-[320px] p-3">
  <div class="flex items-center gap-x-2 bg-purple-300 text-purple-700 text-lg text-center font-bold p-3 rounded-md">
    <span>Web Image Downloader</span>
    <span @click="openSettings"
      class="ms-auto p-2 hover:bg-purple-100 rounded-full cursor-pointer transition duration-150">
      <svg t="1743943377708" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
        p-id="2311" width="16" height="16">
        <path
          d="M512 661.994667q61.994667 0 106.005333-44.010667t44.010667-106.005333-44.010667-106.005333-106.005333-44.010667-106.005333 44.010667-44.010667 106.005333 44.010667 106.005333 106.005333 44.010667zM829.994667 554.005333l90.005333 69.994667q13.994667 10.005333 4.010667 28.010667l-85.994667 148.010667q-8 13.994667-26.005333 8l-106.005333-42.005333q-42.005333 29.994667-72 42.005333l-16 112q-4.010667 18.005333-20.010667 18.005333l-172.010667 0q-16 0-20.010667-18.005333l-16-112q-37.994667-16-72-42.005333l-106.005333 42.005333q-18.005333 5.994667-26.005333-8l-85.994667-148.010667q-10.005333-18.005333 4.010667-28.010667l90.005333-69.994667q-2.005333-13.994667-2.005333-42.005333t2.005333-42.005333l-90.005333-69.994667q-13.994667-10.005333-4.010667-28.010667l85.994667-148.010667q8-13.994667 26.005333-8l106.005333 42.005333q42.005333-29.994667 72-42.005333l16-112q4.010667-18.005333 20.010667-18.005333l172.010667 0q16 0 20.010667 18.005333l16 112q37.994667 16 72 42.005333l106.005333-42.005333q18.005333-5.994667 26.005333 8l85.994667 148.010667q10.005333 18.005333-4.010667 28.010667l-90.005333 69.994667q2.005333 13.994667 2.005333 42.005333t-2.005333 42.005333z"
          fill="#222222" p-id="2312"></path>
      </svg>
    </span>
  </div>
  </div>
  <div class="flex flex-col space-y-2 mt-3">
    <ul class="flex items-center flex-wrap gap-1">
      <template x-for="path in paths" :key="path">
        <li x-data="Path" x-text="path" @click="toggleSelection"
          class="cursor-pointer rounded-md text-sm px-2 py-1 max-w-[100px] truncate" :class="classes">
        </li>
      </template>
      <li x-data="AddButton" class="flex items-center gap-x-1">
        <span @click="toggleAdding" x-show="showAddButton"
          class="bg-gray-300 text-gray-700 cursor-pointer rounded-md text-sm px-2 py-1">+</span>
        <div x-show="showCommitButton" class="flex items-center gap-x-1">
          <input @change="setPathValue" :value="pathValue"
            class="focus:outline-none bg-gray-100 text-gray-600 rounded-md px-2 py-1" />
        </div>
        <span @click="commitAdding" x-show="showCommitButton"
          class="bg-gray-300 text-gray-700 cursor-pointer rounded-md text-sm px-2 py-1">âˆš</span>
        <span @click="toggleAdding" x-show="showCommitButton"
          class="bg-gray-300 text-gray-700 cursor-pointer rounded-md text-sm px-2 py-1">x</span>
      </li>
    </ul>
    <div x-show="targetDirectory" class="bg-orange-100 text-orange-700 p-3 rounded-md">
      <div class="flex items-center">
        <span>Download to:</span>
        <span @click="clearPaths"
          class="cursor-pointer ms-auto text-sm w-6 h-6 leading-6 text-center rounded-full hover:bg-white transition duration-150">x</span>
      </div>
      <p x-text="targetDirectory"
        class="font-semibold tracking-wide text-md text-wrap break-all underline underline-offset-4"></p>
    </div>
    <div class="flex items-center gap-x-1">
      <button @click="saveSelected"
        class="hover:opacity-70 cursor-pointer font-semibold px-3 py-2 bg-green-300 text-green-700 rounded-md">
        Save Selected
      </button>
      <button @click="saveAll"
        class="hover:opacity-70 cursor-pointer font-semibold px-3 py-2 bg-blue-300 text-blue-700 rounded-md">
        Save All
      </button>
      <button @click="clean"
        class="hover:opacity-70 cursor-pointer font-semibold px-3 py-2 bg-pink-300 text-pink-700 rounded-md">
        Clean
      </button>
      <div class="ms-auto rounded-md overflow-hidden flex items-center">
        <span x-text="selectedCount"
          class="w-3 h-3 p-3 bg-green-500 text-white font-bold flex items-center justify-center">
        </span>
        <span x-text="imageCount" class="w-3 h-3 p-3 bg-red-500 text-white font-bold flex items-center justify-center">
        </span>
      </div>
    </div>
    <ul class="hidden">
      <template x-for="url in images" :key="url">
        <li x-data="ImageTemplate">
          <img :src="src">
        </li>
      </template>
    </ul>
    <ul class="grid grid-cols-4 gap-1 max-h-[300px] overflow-y-scroll hide-scrollbar">
      <template x-for="url in visibleImages" :key="url">
        <li x-data="Image" @click="toggleSelection" class="relative">
          <img :src="src" class="w-[60px] h-[60px] object-cover rounded-md cursor-pointer">
          <span x-text="width"
            class="absolute bottom-0 right-0 p-1 rounded-md text-[8px] bg-orange-600 text-white font-semibold"></span>
          <div x-show="selected"
            class="absolute top-0 right-0 w-4 h-4 border-2 border-gray-100 p-1 bg-green-600 rounded-full"></div>
        </li>
      </template>
    </ul>
    <div class="flex items-center gap-x-1">
      <button @click="loadMore" x-show="loadMoreAvailable"
        class="flex-1 hover:opacity-70 cursor-pointer font-semibold px-3 py-2 bg-green-100 text-green-600 rounded-md">
        Load More
      </button>
      <button @click="loadLess" x-show="loadLessAvailable"
        class="flex-1 hover:opacity-70 cursor-pointer font-semibold px-3 py-2 bg-red-100 text-red-600 rounded-md">
        Load Less
      </button>
    </div>
  </div>
</body>

</html>