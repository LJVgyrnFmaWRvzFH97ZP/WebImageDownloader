<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Web Image Downloader</title>
  <link href="../dist/css/styles.css" rel="stylesheet">
  <script defer type="module" src="./popup.js"></script>
  <script defer src="../dist/js/alpine-csp.min.js"></script>
</head>

<body x-data="WebImageDownloaderPopup" class="w-[320px]">
  <div class="text-white bg-purple-900 p-3 flex items-center">
    <span class="text-2xl font-bold">Web Image Downloader</span>
  </div>
  <div class="flex flex-col space-y-2 p-3">
    <ul class="flex items-center flex-wrap gap-1">
      <template x-for="path in paths" :key="path">
        <li x-data="Path" x-text="path" @click="toggleSelection"
          class="cursor-pointer rounded-md text-sm px-2 py-1 max-w-[100px] truncate" :class="classes">
        </li>
      </template>
      <li x-data="AddButton" class="flex items-center gap-x-1">
        <span @click="toggleAdding" x-show="showAddButton"
          class="bg-gray-300 text-gray-700 cursor-pointer rounded-md text-sm px-2 py-1">+</span>
        <div x-show="showCommitButton" class="flex items-center gap-x-1">
          <input @change="setPathValue" :value="pathValue"
            class="focus:outline-none bg-gray-100 text-gray-600 rounded-md px-2 py-1" />
        </div>
        <span @click="commitAdding" x-show="showCommitButton"
          class="bg-gray-300 text-gray-700 cursor-pointer rounded-md text-sm px-2 py-1">âˆš</span>
        <span @click="toggleAdding" x-show="showCommitButton"
          class="bg-gray-300 text-gray-700 cursor-pointer rounded-md text-sm px-2 py-1">x</span>
      </li>
    </ul>
    <div class="">
      <div class="flex items-center ">
        <span>Download to:</span>
        <span x-show="targetDirectory" @click="clearPaths"
          class="cursor-pointer ms-auto w-5 h-5 leading-5 flex items-center shrink-0 justify-center rounded-md bg-gray-300 text-gray-700">x</span>
      </div>
      <div x-text="targetDirectory" class="underline"></div>
    </div>
    <div class="flex items-center gap-x-1">
      <button @click="saveSelected"
        class="hover:opacity-70 cursor-pointer font-semibold px-3 py-2 bg-green-300 text-green-700 rounded-md">
        Save Selected
      </button>
      <button @click="saveAll"
        class="hover:opacity-70 cursor-pointer font-semibold px-3 py-2 bg-blue-300 text-blue-700 rounded-md">
        Save All
      </button>
      <button @click="clean"
        class="hover:opacity-70 cursor-pointer font-semibold px-3 py-2 bg-pink-300 text-pink-700 rounded-md">
        Clean
      </button>
      <div class="ms-auto rounded-md overflow-hidden flex items-center">
        <span x-text="selectedCount"
          class="w-3 h-3 p-3 bg-green-500 text-white font-bold flex items-center justify-center">
        </span>
        <span x-text="imageCount" class="w-3 h-3 p-3 bg-red-500 text-white font-bold flex items-center justify-center">
        </span>
      </div>
    </div>
    <ul class="hidden">
      <template x-for="url in images" :key="url">
        <li x-data="ImageTemplate">
          <img :src="src">
        </li>
      </template>
    </ul>
    <ul class="grid grid-cols-4 gap-1 max-h-[300px] overflow-y-scroll hide-scrollbar">
      <template x-for="url in visibleImages" :key="url">
        <li x-data="Image" @click="toggleSelection" class="relative">
          <img :src="src" class="w-[60px] h-[60px] object-cover rounded-md cursor-pointer">
          <span x-text="width"
            class="absolute bottom-0 right-0 p-1 rounded-md text-[8px] bg-orange-600 text-white font-semibold"></span>
          <div x-show="selected"
            class="absolute top-0 right-0 w-4 h-4 border-2 border-gray-100 p-1 bg-green-600 rounded-full"></div>
        </li>
      </template>
    </ul>
    <div class="flex items-center gap-x-1">
      <button @click="loadMore" x-show="loadMoreAvailable"
        class="flex-1 hover:opacity-70 cursor-pointer font-semibold px-3 py-2 bg-green-100 text-green-600 rounded-md">
        Load More
      </button>
      <button @click="loadLess" x-show="loadLessAvailable"
        class="flex-1 hover:opacity-70 cursor-pointer font-semibold px-3 py-2 bg-red-100 text-red-600 rounded-md">
        Load Less
      </button>
    </div>
  </div>
</body>

</html>